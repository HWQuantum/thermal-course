
# Lab 2 - The Heat Diffusion Equation - Finite Difference
# Overview

In this lab, we will simulate the diffusion of heat in a one-dimensional rod using the finite difference method. The goal is to numerically solve the heat equation and observe how temperature evolves over time. We will discretise both space and time, apply appropriate boundary conditions, and explore the stability of the numerical method.

This simulation demonstrates how a continuous differential equation can be approximated by discrete update rules. By implementing the finite difference method, we observe how heat spreads from regions of high temperature to regions of low temperature.

---

## How will you be assessed?

At the end of the lab, you will submit a single MATLAB .m file that performs the simulation and generates the required plots. Your code should be clearly commented to demonstrate understanding of the numerical method and the underlying physics.

In order to pass this lab, your code must:

- Correctly implement the finite difference method
- Produce physically reasonable results
- Include appropriate plots with labelled axes

This is a pass/fail lab.

---

## Learning Outcomes

The objectives of this lab are to:

- Understand the one-dimensional heat equation.
- Implement a finite difference approximation.
- Explore numerical stability conditions.
- Interpret the physical meaning of diffusion.

---

# Background

```{figure} ../assets/images/Heat_diffusion.png
:width: 80%
:align: center
:name: target

The problem that we will solve is given an initial spatial temperature distribution at time = 0, what is the temperature distribution at time = $t$?
```


## One dimensional diffusion equation

The heat diffusion equation (or simply, the heat equation) describes how heat flows in a medium over time. In one dimension, it is given by:
%
\begin{align}
\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}
\end{align}
%
where $T(x,t)$ is the temperature at position $x$ and time $t$, and $\alpha$ is the thermal diffusivity.  This equation assumes that we have a constant thermal diffusivity $\alpha$, there are no internal heat source, and this for the one-dimensional case (e.g. a rod).  Simple modifications of the equation can introduce additional features, such as internal sources of heat, and the same concepts are applied when solving the equation in 2 and 3 dimensions. 

## Two dimensional diffusion equation

The two-dimensional diffusion equation is given by
%
\begin{align}
\frac{\partial T(x, y, t)}{\partial t} = \alpha \left( \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} \right) = \alpha \nabla^2 T.
\end{align}
%


---

## Finite Difference Approximation

We discretise space and time:

- $x_i = i \Delta x$
- $t^n = n \Delta t$

The second spatial derivative is approximated by:

$$
\frac{\partial^2 T}{\partial x^2}
\approx
\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\Delta x)^2}.
$$

The time derivative is approximated by:

$$
\frac{\partial T}{\partial t}
\approx
\frac{T_i^{n+1} - T_i^n}{\Delta t}.
$$

Substituting gives the explicit update rule:

$$
T_i^{n+1}
=
T_i^n
+
r \left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \right),
$$

where:

$$
r = \frac{\alpha \Delta t}{(\Delta x)^2}.
$$

---

## Stability Condition

For stability of the explicit method, we require:

$$
r \le \frac{1}{2}.
$$

If this condition is violated, the numerical solution becomes unstable.

---

# Simulation Details

You will simulate heat diffusion along a rod of length $L$.

1. Discretise the rod into $N$ spatial points.
2. Choose a time step $\Delta t$ satisfying the stability condition.
3. Apply boundary conditions (e.g., fixed temperature at both ends).
4. Evolve the temperature distribution over time.

---

## Physical Interpretation

Heat flows from regions of high temperature to low temperature. The finite difference method allows us to approximate this process numerically. Over time, sharp temperature gradients smooth out, and the system approaches thermal equilibrium.

The rate of diffusion depends on the thermal diffusivity $\alpha$. Larger values of $\alpha$ lead to faster smoothing of temperature differences.

---

## Pseudo Code

```{admonition} Algorithm
:class: algorithm
:name: alg-heat-diffusion

**Heat Diffusion Simulation (1D Finite Difference)**

**Initialisation**

1. Define rod length $L$ and number of spatial points $N$.
2. Define thermal diffusivity $\alpha$.
3. Choose spatial step size $\Delta x = L/(N-1)$.
4. Choose time step $\Delta t$ such that
   $$
   r = \frac{\alpha \Delta t}{(\Delta x)^2} \le \frac{1}{2}.
   $$
5. Initialise temperature vector $T$ with chosen initial condition.
6. Apply boundary conditions.

**Time Evolution**

For each time step $n$:

1. For each interior point $i = 2, \dots, N-1$:
   $$
   T_i^{n+1}
   =
   T_i^n
   +
   r \left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \right)
   $$

2. Apply boundary conditions to $T^{n+1}$.
3. Store temperature profile if required.
4. Plot temperature profile at chosen intervals.
```

# Target Results

You should observe:
	•	Heat diffusing smoothly along the rod.
	•	Temperature gradients decreasing with time.
	•	Stability when $r \le 1/2$.
	•	Instability when the stability condition is violated.

# Further Investigation

	1.	Explore different initial temperature distributions.
	2.	Investigate what happens when the stability condition is violated.
	3.	Compare numerical results with analytical solutions (if available).
	4.	Extend the simulation to two dimensions.