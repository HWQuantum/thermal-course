{"version":3,"kind":"Article","sha256":"5267fe59ae48de5378b2169d715703673651702dd01308a4257838476befe8ad","slug":"lab3","location":"/labs/lab3.md","dependencies":[],"frontmatter":{"title":"Lab 3 - The Heat Diffusion Equation - Fourier Transform","authors":[{"nameParsed":{"literal":"Physics, Heriot-Watt University","given":"Heriot-Watt University","family":"Physics"},"name":"Physics, Heriot-Watt University","id":"contributors-lab3-generated-uid-0"}],"exports":[{"format":"md","filename":"lab3.md","url":"/lab3-0e39f10a41fa9f8d2621736094119e86.md"}],"downloads":[{"title":"Download PDF","url":"/thermal-course/exports/lab3.pdf","internal":true,"static":false}],"content_includes_title":false,"numbering":{"title":{"offset":1}}},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tXjz2KF5qT"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"emBDjs9UB7"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"In this lab, we will solve the heat diffusion equation via a Fourier-based method, representing the conduction of heat through a solid as time evolves. The simulation will show how a system with an initial localised area of heat will transition to a system where the heat is distributed throughout space.  We will start by initialising an array that represents where the heat in a sample is and then use the Fourier method to solve the equation and update the spatial distribution of heat as time evolves.  We find that the heat distribution at time ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"sHQbLzMfcK"},{"type":"inlineMath","value":"t+\\Delta t","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mi mathvariant=\"normal\">Δ</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t+\\Delta t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"xXgXRMqJ3n"},{"type":"text","value":" is equal to the inverse Fourier transform of the Fourier transform of the current heat distribution multiplied by a Gaussian function.  In the Fourier domain, the multiplication by the Gaussian attenuates the high spatial frequency components of the temperature distribution.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"D3K7r5BS7u"}],"key":"lop8HZlAoq"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"This simulation is an example of using a Fourier-based approach for solving a second-order partial differential equation.  As with the finite difference method, a similar approach can be used to solve many other similar differential equations.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XRmj9Wzqg7"}],"key":"kGt5Xamgm1"},{"type":"thematicBreak","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"z6kKhXah9y"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Learning Outcomes","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"NSlCAV5RLI"}],"identifier":"learning-outcomes","label":"Learning Outcomes","html_id":"learning-outcomes","implicit":true,"key":"DIiWmpx6ax"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"By the end of this lab you should be able to:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"LFQPvh8rib"}],"key":"lLFocXe6TQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the physical principles behind thermal diffusion.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"kDVNSKYcQU"}],"key":"dwghZQJRNM"}],"key":"pydSkzwr2K"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Learn how to numerically solve the one-dimensional heat equation using Fourier-based methods.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"eekBY129ZM"}],"key":"bHg8bqJsrB"}],"key":"Et2qQ4H7Mt"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implement the method in MATLAB and analyze the temperature evolution in a solid.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"zqU1jh4YoL"}],"key":"OFwdwDB17n"}],"key":"mhARR589JV"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the extension of the method to two and three dimensions.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"nSfkSnE2y8"}],"key":"HY4d3vKWNh"}],"key":"zwwKGTNTSa"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the extension of the method to include the addition of heat sources.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"rdDhJ5Iyyb"}],"key":"NiTadZv2H9"}],"key":"Y53u3o5gC4"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the advantages and disadvantages of this method versus the finite difference approach","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"InNfzEKR8b"}],"key":"cBaNEof6YA"}],"key":"Yx9H40ZLeS"}],"key":"dIKESvRvwQ"},{"type":"thematicBreak","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"C0qzatyKKH"},{"type":"heading","depth":2,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Background","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"lEeKPR4DfS"}],"identifier":"background","label":"Background","html_id":"background","implicit":true,"key":"HXv4Gy3Ssl"},{"type":"heading","depth":3,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Exponential Decay and Newton’s Law of Cooling","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"M9GMOGrkiZ"}],"identifier":"exponential-decay-and-newtons-law-of-cooling","label":"Exponential Decay and Newton’s Law of Cooling","html_id":"exponential-decay-and-newtons-law-of-cooling","implicit":true,"key":"MJICyWZYRv"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Before solving the heat equation, it’s helpful to understand a simpler example of exponential decay, which is Newton’s Law of Cooling. This describes the temperature ( T(t) ) of an object as it cools in a surrounding environment of constant temperature ( T_{\\text{env}} ). The rate of cooling is proportional to the temperature difference","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"LnMeDCRI7E"}],"key":"FpMeFbXoOw"},{"type":"comment","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"aJrpBTCLZS"},{"type":"math","value":"\\frac{dT}{dt} = -\\kappa(T - T_{\\text{env}}),","enumerated":true,"tight":true,"position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"identifier":"eq:newton","label":"eq:newton","html_id":"eq-newton","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>κ</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo>−</mo><msub><mi>T</mi><mtext>env</mtext></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\frac{dT}{dt} = -\\kappa(T - T_{\\text{env}}),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">env</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"1","key":"Bit019CJnG"},{"type":"comment","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"bMAXRddv9N"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"where ( \\kappa > 0 ) is a cooling constant.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"k1pdzoOntc"}],"key":"t0PVkRnMYz"},{"type":"heading","depth":3,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"X2ejNzW7PG"}],"identifier":"solution","label":"Solution","html_id":"solution","implicit":true,"key":"TX2PtEhR6S"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"We can solve this first-order ODE by separating variables","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"dEX4Lz2jvq"}],"key":"r9ccnw7E2i"},{"type":"comment","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"V7jZjLl8M1"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"[\n\\frac{dT}{T - T_{\\text{env}}} = -\\kappa,dt.\n]","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"R8oUSlEGOl"}],"key":"YblUzpOO56"},{"type":"comment","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"SpRbz5lXnp"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Integrating both sides we get","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"BckwV6hsMV"}],"key":"miuEK9FDhc"},{"type":"comment","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"wIpju5qxmA"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"[\n\\ln|T - T_{\\text{env}}| = -\\kappa t + C\n\\quad \\Rightarrow \\quad\nT(t) = T_{\\text{env}} + (T_0 - T_{\\text{env}}) e^{-\\kappa t}.\n]","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"izCwtPkws7"}],"key":"QnYrpoisGQ"},{"type":"comment","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"kK11NkjaG8"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"This shows that the temperature approaches the environment temperature exponentially over time.  It is important to note that to find the temperature at any future time, we only need to know the initial conditions (","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"QhZHs7siEx"},{"type":"inlineMath","value":"T_0","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">T_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Hlbuemmv7j"},{"type":"text","value":" and ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"cpLhwgltGn"},{"type":"inlineMath","value":"T_{\\text{env}}","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mtext>env</mtext></msub></mrow><annotation encoding=\"application/x-tex\">T_{\\text{env}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">env</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"edsJjDxeKK"},{"type":"text","value":") and the time ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"xqcnfuZFoL"},{"type":"inlineMath","value":"t","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"o6jDs4bV0s"},{"type":"text","value":".","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"FxmEzjjVeS"}],"key":"lAlSGjzoa6"},{"type":"heading","depth":3,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"connection to the Heat Equation","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"bYu92bQaCJ"}],"identifier":"connection-to-the-heat-equation","label":"connection to the Heat Equation","html_id":"connection-to-the-heat-equation","implicit":true,"key":"mHJiaRe1K2"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"This solution is of the same form as the solution to the Fourier-transformed heat equation (Equation 4 in this document), where each Fourier mode decays exponentially in time:","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"P8utp9vQpb"}],"key":"N7zloe9jjE"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"[\n\\hat{T}(k,t) = \\hat{T}(k,0) e^{-\\alpha k^2 t}\n]","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"wz7FqVlbvf"}],"key":"zzr3bRPUqQ"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Understanding Newton’s Law of Cooling helps recognise exponential decay in thermal processes, and see how the system relaxes toward equilibrium over time.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"kDXKCy2yZC"}],"key":"V0jiJHLIjl"}],"key":"KbUKmA6x6y"}],"key":"uIBDL9lFkI"},"references":{"cite":{"order":[],"data":{}}}}